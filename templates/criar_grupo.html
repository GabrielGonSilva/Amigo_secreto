{% extends "base.html" %}

{% block title %}Criar Grupo - Amigo Secreto{% endblock %}

{% block content %}
<div class="create-group-container">
    <div class="create-group-header">
        <h1><i class="fas fa-plus-circle"></i> Criar Novo Grupo</h1>
        <p>Organize um novo grupo de amigo secreto</p>
    </div>

    <div class="create-group-card card">
        <form method="POST" action="{{ url_for('criar_grupo') }}" id="groupForm">
            <div class="form-section">
                <h3><i class="fas fa-info-circle"></i> Informações Básicas</h3>

                <div class="form-group">
                    <label for="nome">
                        <i class="fas fa-users"></i> Nome do Grupo *
                    </label>
                    <input type="text" id="nome" name="nome" required
                           placeholder="Ex: Família 2024, Trabalho, Amigos da Faculdade"
                           maxlength="100">
                </div>

                <div class="form-group">
                    <label for="descricao">
                        <i class="fas fa-file-alt"></i> Descrição
                    </label>
                    <textarea id="descricao" name="descricao" rows="3"
                              placeholder="Descreva o grupo, regras, ou qualquer informação importante..."></textarea>
                    <small class="form-text">Os participantes verão esta descrição</small>
                </div>
            </div>

            <div class="form-section">
                <h3><i class="fas fa-calendar-alt"></i> Detalhes do Evento</h3>

                <div class="form-grid">
                    <div class="form-group">
                        <label for="data_evento">
                            <i class="fas fa-calendar"></i> Data do Evento
                        </label>
                        <input type="datetime-local" id="data_evento" name="data_evento">
                    </div>

                    <div class="form-group">
                        <label for="local_evento">
                            <i class="fas fa-map-marker-alt"></i> Local
                        </label>
                        <input type="text" id="local_evento" name="local_evento"
                               placeholder="Ex: Casa da Maria, Restaurante X">
                    </div>
                </div>

                <div class="form-grid">
                    <div class="form-group">
                        <label for="valor_minimo">
                            <i class="fas fa-money-bill-wave"></i> Valor Mínimo (R$)
                        </label>
                        <input type="number" id="valor_minimo" name="valor_minimo"
                               min="0" step="0.01"
                               placeholder="Ex: 50.00">
                    </div>

                    <div class="form-group">
                        <label for="valor_maximo">
                            <i class="fas fa-money-bill-wave"></i> Valor Máximo (R$)
                        </label>
                        <input type="number" id="valor_maximo" name="valor_maximo"
                               min="0" step="0.01"
                               placeholder="Ex: 100.00">
                    </div>
                </div>
            </div>

            <div class="form-section">
                <h3><i class="fas fa-cog"></i> Configurações</h3>

                <div class="form-check">
                    <input type="checkbox" id="allow_repeat" name="allow_repeat" checked>
                    <label for="allow_repeat">
                        Permitir que participantes sortem a mesma pessoa do ano anterior
                    </label>
                </div>

                <div class="form-check">
                    <input type="checkbox" id="auto_close" name="auto_close">
                    <label for="auto_close">
                        Fechar grupo automaticamente após a data do evento
                    </label>
                </div>

                <div class="form-check">
                    <input type="checkbox" id="notify_all" name="notify_all" checked>
                    <label for="notify_all">
                        Notificar todos os participantes quando alguém entrar no grupo
                    </label>
                </div>
            </div>

            <div class="form-actions">
                <a href="{{ url_for('dashboard') }}" class="btn btn-secondary">
                    <i class="fas fa-times"></i> Cancelar
                </a>
                <button type="submit" class="btn btn-success">
                    <i class="fas fa-check"></i> Criar Grupo
                </button>
            </div>
        </form>
    </div>

    <div class="tips-card card">
        <h3><i class="fas fa-lightbulb"></i> Dicas para um bom grupo</h3>
        <div class="tips-list">
            <div class="tip">
                <i class="fas fa-users"></i>
                <p><strong>Convide pessoas</strong> usando o código de acesso</p>
            </div>
            <div class="tip">
                <i class="fas fa-gift"></i>
                <p><strong>Defina valores</strong> para que todos fiquem confortáveis</p>
            </div>
            <div class="tip">
                <i class="fas fa-calendar"></i>
                <p><strong>Marque a data</strong> para que todos se preparem</p>
            </div>
            <div class="tip">
                <i class="fas fa-comment"></i>
                <p><strong>Descreva bem</strong> para evitar confusões</p>
            </div>
        </div>
    </div>
</div>

<style>
.create-group-container {
    max-width: 800px;
    margin: 0 auto;
    padding: 20px;
}

.create-group-header {
    text-align: center;
    margin-bottom: 40px;
}

.create-group-header h1 {
    color: #2C3E50;
    margin-bottom: 10px;
}

.create-group-header p {
    color: #666;
    font-size: 1.1rem;
}

.create-group-card {
    margin-bottom: 30px;
}

.form-section {
    margin-bottom: 40px;
    padding-bottom: 30px;
    border-bottom: 2px solid #f0f0f0;
}

.form-section:last-child {
    border-bottom: none;
    margin-bottom: 0;
    padding-bottom: 0;
}

.form-section h3 {
    color: #2C3E50;
    margin-bottom: 25px;
    display: flex;
    align-items: center;
    gap: 10px;
}

.form-section h3 i {
    color: var(--primary-color);
}

.form-group {
    margin-bottom: 25px;
}

.form-group label {
    display: flex;
    align-items: center;
    gap: 10px;
    margin-bottom: 10px;
    font-weight: 600;
    color: #333;
}

.form-group label i {
    color: var(--primary-color);
}

.form-group input,
.form-group textarea,
.form-group select {
    width: 100%;
    padding: 15px;
    border: 2px solid #ddd;
    border-radius: 10px;
    font-size: 1rem;
    font-family: inherit;
    transition: all 0.3s;
}

.form-group input:focus,
.form-group textarea:focus,
.form-group select:focus {
    outline: none;
    border-color: var(--primary-color);
    box-shadow: 0 0 0 3px rgba(102, 126, 234, 0.1);
}

.form-grid {
    display: grid;
    grid-template-columns: 1fr 1fr;
    gap: 20px;
}

@media (max-width: 768px) {
    .form-grid {
        grid-template-columns: 1fr;
    }
}

.form-check {
    display: flex;
    align-items: flex-start;
    gap: 12px;
    margin-bottom: 20px;
}

.form-check input {
    margin-top: 5px;
}

.form-check label {
    font-size: 0.95rem;
    color: #555;
    line-height: 1.5;
}

.form-actions {
    display: flex;
    gap: 15px;
    justify-content: flex-end;
    margin-top: 40px;
    padding-top: 30px;
    border-top: 2px solid #f0f0f0;
}

.tips-card {
    margin-top: 30px;
}

.tips-list {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
    gap: 20px;
    margin-top: 20px;
}

.tip {
    display: flex;
    gap: 15px;
    align-items: flex-start;
    padding: 15px;
    background: #f8f9fa;
    border-radius: 10px;
}

.tip i {
    color: var(--primary-color);
    font-size: 1.2rem;
    margin-top: 3px;
}

.tip p {
    margin: 0;
    line-height: 1.5;
}
</style>

<script>
document.addEventListener('DOMContentLoaded', function() {
    const form = document.getElementById('groupForm');
    const valorMinimo = document.getElementById('valor_minimo');
    const valorMaximo = document.getElementById('valor_maximo');

    // Validação de valores
    function validateValues() {
        const min = parseFloat(valorMinimo.value);
        const max = parseFloat(valorMaximo.value);

        if (min && max && min > max) {
            alert('O valor mínimo não pode ser maior que o valor máximo!');
            return false;
        }

        return true;
    }

    // Validação de data
    const dataEvento = document.getElementById('data_evento');
    if (dataEvento) {
        // Setar data mínima como hoje
        const hoje = new Date().toISOString().slice(0, 16);
        dataEvento.min = hoje;
    }

    form.addEventListener('submit', function(e) {
        if (!validateValues()) {
            e.preventDefault();
            return false;
        }

        // Validação do nome
        const nome = document.getElementById('nome').value.trim();
        if (nome.length < 3) {
            alert('O nome do grupo deve ter pelo menos 3 caracteres.');
            e.preventDefault();
            return false;
        }

        return true;
    });

    // Formatar valores monetários
    function formatCurrency(input) {
        if (!input) return;

        input.addEventListener('blur', function() {
            if (this.value) {
                let value = parseFloat(this.value);
                if (!isNaN(value)) {
                    this.value = value.toFixed(2);
                }
            }
        });
    }

    formatCurrency(valorMinimo);
    formatCurrency(valorMaximo);
});
</script>
{% endblock %}
